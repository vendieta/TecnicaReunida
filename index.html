<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sistema de √ìrdenes de Trabajo</title>
  <link rel="icon" type="image/png" href="./logo.png">
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <!-- Pantalla de Login -->
  <div id="loginView" class="login-view">
    <div class="login-card">
      <h2>Acceso</h2>
      <p class="muted">Ingrese sus credenciales para continuar</p>
      <form id="loginForm" class="login-form">
        <label for="loginUser">Usuario</label>
        <input type="text" id="loginUser" autocomplete="username" required placeholder="usuario" />
        <label for="loginPass">Contrase√±a</label>
        <input type="password" id="loginPass" autocomplete="current-password" required placeholder="contrase√±a" />
        <button type="submit" id="btnLogin">Entrar</button>
        <p id="loginError" class="error" hidden>Usuario o contrase√±a incorrectos.</p>
      </form>
    </div>
  </div>

  <!-- App principal -->
  <div id="app" class="app hidden">
    <header class="topbar">
      <img class="logoHeader" src="./logo.png" alt="Logo">
      <div class="brand">√ìrdenes de Trabajo</div>
      <div class="spacer"></div>
      <div class="userbox">
        <span id="userName"></span>
        <button id="btnLogout" class="btn-light small">Salir</button>
      </div>
    </header>

    <div class="container">
      <h1>√ìrdenes de Trabajo</h1>

      <form id="formOrden">
        <!-- 1Ô∏è‚É£ √Årea -->
        <div>
          <label for="area">√Årea</label>
          <select id="area" required>
            <option value="">Seleccione</option>
            <option>Producci√≥n</option>
            <option>Mantenimiento</option>
            <option>Calidad</option>
            <option>Log√≠stica</option>
            <option>Compras</option>
            <option>Ventas</option>
            <option>Seguridad</option>
            <option>Proyectos</option>
            <option>Ingenier√≠a</option>
            <option>Almac√©n</option>
            <option>Recursos Humanos</option>
            <option>Tecnolog√≠a (TI)</option>
            <option>Finanzas</option>
            <option>Planta A</option>
            <option>Planta B</option>
            <option>Laboratorio</option>
            <option>Taller 1</option>
            <option>Taller 2</option>
            <option>Servicios Generales</option>
            <option>Administraci√≥n</option>
          </select>
        </div>

        <!-- 2Ô∏è‚É£ Fecha -->
        <div>
          <label for="fecha">Fecha actual</label>
          <input type="text" id="fecha" readonly/>
        </div>

        <!-- 3Ô∏è‚É£ Supervisor -->
        <div>
          <label for="supervisor">Supervisor responsable</label>
          <select id="supervisor" required>
            <option value="">Seleccione</option>
          </select>
        </div>

        <!-- 4Ô∏è‚É£ Tipo de trabajo -->
        <div>
          <label for="trabajo">Tipo de trabajo</label>
          <select id="trabajo" required>
            <option value="">Seleccione</option>
            <option>El√©ctrico</option>
            <option>Mec√°nico</option>
            <option>Hidr√°ulico</option>
            <option>Soldadura</option>
            <option>Automatizaci√≥n</option>
            <option>Montaje</option>
            <option>Fabricaci√≥n</option>
            <option>Limpieza</option>
          </select>
        </div>

        <!-- 5Ô∏è‚É£ Magnitud -->
        <div>
          <label for="magnitud">Magnitud del trabajo</label>
          <select id="magnitud" required>
            <option value="">Seleccione</option>
            <option>Peque√±o</option>
            <option>Mediano</option>
            <option>Grande</option>
            <option>Fabricaci√≥n</option>
            <option>Montaje</option>
            <option>Correcci√≥n</option>
            <option>Inspecci√≥n</option>
          </select>
        </div>

        <!-- 6Ô∏è‚É£ Descripci√≥n -->
        <div class="full">
          <label for="descripcion">Descripci√≥n del trabajo</label>
          <textarea id="descripcion" placeholder="Describa el trabajo..." required></textarea>
        </div>

        <!-- 7Ô∏è‚É£ Personal -->
        <div class="full">
          <label>Personal asignado</label>
          <small class="hint">Se filtra autom√°ticamente seg√∫n el tipo de trabajo.</small>
          <div class="toolbar">
            <button type="button" id="btnSelTodo" class="btn-light">Seleccionar todo</button>
            <button type="button" id="btnSelNada" class="btn-light">Deseleccionar</button>
          </div>
          <div id="listaPersonal" class="personal-grid"></div>
        </div>

        <!-- 8Ô∏è‚É£ Tiempos -->
        <div>
          <label for="inicio">Inicio</label>
          <input type="datetime-local" id="inicio" required/>
        </div>
        <div>
          <label for="fin">Fin</label>
          <input type="datetime-local" id="fin" required/>
        </div>
        <div>
          <label for="duracion">Duraci√≥n (d√≠as / horas)</label>
          <input type="text" id="duracion" readonly placeholder="Se calcula autom√°ticamente"/>
        </div>

        <!-- 9Ô∏è‚É£ Responsable de √°rea -->
        <div>
          <label for="responsable">Responsable de planta en el √°rea</label>
          <input type="text" id="responsable" placeholder="Ej. Ing. Ram√≠rez" required/>
        </div>

        <!-- üîü Calificaci√≥n -->
        <!-- <div>
          <label for="calificacion">Calificaci√≥n</label>
          <select id="calificacion" required>
            <option value="">Seleccione</option>
            <option>Excelente</option>
            <option>Bueno</option>
            <option>Regular</option>
            <option>Deficiente</option>
          </select>
        </div> -->

        <!-- WhatsApp -->
        <div>
          <label for="telefono">WhatsApp destino (opcional)</label>
          <input type="tel" id="telefono" placeholder="Ej: 593987654321"/>
        </div>

        <!-- Botones -->
        <div class="buttons full">
          <button type="button" id="btnAgregar">‚ûï Agregar</button>
          <button type="reset" id="btnLimpiar">üßπ Limpiar</button>
          <button type="button" id="btnExportar">üì§ Exportar CSV</button>
        </div>
      </form>

      <!-- Tabla -->
      <div class="table-wrap">
        <table id="tablaOrdenes">
          <thead>
            <tr>
              <th>n¬∞</th>
              <th>√Årea</th>
              <th>Fecha</th>
              <th>Supervisor</th>
              <th>Trabajo</th>
              <th>Magnitud</th>
              <th>Descripci√≥n</th>
              <th>Personal</th>
              <th>Inicio</th>
              <th>Fin</th>
              <th>Duraci√≥n</th>
              <th>Resp. √°rea</th>
              <th>Calificaci√≥n</th>
              <th>WhatsApp</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" src="app.js"></script>
</body>
</html>
